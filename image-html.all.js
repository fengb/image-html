/*! image-html.all v0.4.0dev - https://github.com/fengb/image-html */
!function t(r,n,e){function a(o,i){if(!n[o]){if(!r[o]){var u="function"==typeof require&&require;if(!i&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[o]={exports:{}};r[o][0].call(f.exports,function(t){var n=r[o][1][t];return a(n?n:t)},f,f.exports,t,r,n,e)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<e.length;o++)a(e[o]);return a}({1:[function(t,r,n){window.ImageHtml=t("./src/image-html")},{"./src/image-html":9}],2:[function(t,r,n){var e=r.exports=function(t,r){var n=document.createElement("canvas");return n.width=t||300,n.height=r||150,n};e.Image=function(){var t=document.createElement("img");return t}},{}],3:[function(t,r,n){function e(t){var r=t.toString(16);return 1==r.length?"0"+r:r}var a=t("./util"),s=255,o=r.exports=function(t,r,n,e){null==e&&(e=s),this.r=t,this.g=r,this.b=n,this.a=e};o.prototype.equals=function(t){return this.constructor===(t&&t.constructor)&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},o.prototype.rgb=function(){return[this.r,this.g,this.b]},o.prototype.rgba=function(){return[this.r,this.g,this.b,this.a]},o.prototype.css=function(){switch(this.a){case s:return"#"+this.hex();case 0:return"transparent";default:return a.format("rgba({0},{1},{2},{3})",this.r,this.g,this.b,a.round(this.a/s,3))}},o.prototype.hex=function(){return this.a===s?e(this.r)+e(this.g)+e(this.b):e(this.r)+e(this.g)+e(this.b)+e(this.a)},o.rgb=function(t,r,n){return new o(t,r,n)},o.rgba=function(t,r,n,e){return new o(t,r,n,e)},o.hex=function(t){var r,n=parseInt(t.substr(0,2),16),e=parseInt(t.substr(2,2),16),a=parseInt(t.substr(4,2),16);return t.length>6&&(r=parseInt(t.substr(6,2),16)),o.rgba(n,e,a,r)}},{"./util":12}],4:[function(t,r,n){var e=t("../util.js").format;r.exports=function(t,r){return{css:e("#{0} { width: {1}px; margin: 0; overflow: hidden }\n#{0} i { float: left; width: 1px; height: 1px; }",r,t.cols),html:function(){for(var n=e('<p id="{0}"\n>',r),a=0;a<t.rows;a++)for(var s=0;s<t.cols;s++)n+=e('<i style="background: {0}"></i\n>',t[a][s].css());return n+"</p>"}(),js:null}}},{"../util.js":12}],5:[function(t,r,n){var e=t("../util.js").format,a=t("../pixel-segments.js");r.exports=function(t,r){var n=a(t);return{css:e("#{0} { width: {1}px; margin: 0; overflow: hidden }\n#{0} i { float: left; width: 1px; height: 1px; }",r,t.cols),html:function(){for(var t=e('<p id="{0}"\n>',r),a=0;a<n.length;a++)for(var s=0;s<n[a].length;s++){var o=n[a][s];t+=o.length>1?e('<i style="background: {0}; width: {1}px"></i\n>',o.value.css(),o.length):e('<i style="background: #{0}"></i\n>',o.value.hex())}return t+"</p>"}(),js:null}}},{"../pixel-segments.js":10,"../util.js":12}],6:[function(t,r,n){function e(t){var r=[];for(var n in t)r.push(a.format("{0}: {1}",n,t[n]));return r}var a=t("../util"),s=t("../pixel-segments.js");r.exports=function(t,r){for(var n=s(t),e=[],i=0;i<n.length;i++)e.push.apply(e,n[i]);for(var u=[],l=0;l<e.length;l++){var f=e[l];f.styles={background:f.value.css(),width:f.length+"px"},u.push(f.styles)}var h=new o(u);return{css:a.format("#{0} { width: {1}px; margin: 0; overflow: hidden; }\n#{0} i { float: left; height: 1px; }\n",r,t.cols)+h.classes("#"+r).join("\n"),html:function(){for(var t=a.format('<p id="{0}"\n>',r),n=0;n<e.length;n++){var s=e[n];t+=a.format("<i {0}></i\n>",h.attrsFor(s.styles))}return t+"</p>"}(),js:null}};var o=r.exports.CssClasser=function(t){var r=[];t.forEach(function(t){r.push.apply(r,e(t))});var n=a.counter(r),s=a.endlessGenerator("abcdefghijklmnopqrstuvwxyz"),o=n.sortByMostFrequent();this._classes={};for(var i=0;i<o.length;i++){var u=o[i][0],l=o[i][1];l>1&&(this._classes[u]=s())}};o.prototype.classes=function(t){var r=[];for(var n in this._classes)r.push(a.format("{0} .{1} { {2} }",t,this._classes[n],n));return r},o.prototype.attrsFor=function(t){t=e(t);for(var r=[],n=[],s=0;s<t.length;s++){var o=t[s];this._classes[o]?r.push(this._classes[o]):n.push(o)}var i=[];return r.length>0&&i.push(a.format('class="{0}"',r.join(" "))),n.length>0&&i.push(a.format('style="{0}"',n.join("; "))),i.join(" ")}},{"../pixel-segments.js":10,"../util":12}],7:[function(t,r,n){function e(t,r){for(var n in t)if(a.arrayEquals(t[n],r))return{tag:n,unmatchedStyles:[]};for(var e in t)for(var s=0;s<r.length;s++){var o=t[e];if(e.length<3&&-1!=t[e].indexOf(r[s]))return{tag:e,unmatchedStyles:a.arrayDiff(r,o||[])}}return{tag:null,unmatchedStyles:r}}var a=t("../util"),s=t("../pixel-segments.js");r.exports=function(t,r){for(var n=s(t),e=[],o=0;o<n.length;o++)e.push.apply(e,n[o]);for(var u=[],l=0;l<e.length;l++){var f=e[l];f.styles=[a.format("background: {0}",f.value.css()),a.format("width: {0}px",f.length)],u.push(f.styles)}var h=i.fromStylesElements(u);return{css:a.format('#{0} { width: {1}px; margin: 0; overflow: hidden }\n#{0} * { float: left; height: 1px; vertical-align: baseline; margin: 0; padding: 0; border-collapse: collapse }\n#{0} *:before, #{0}:after { content: "" }\n',r,t.cols)+h.styles("#"+r).join("\n"),html:a.format('<div id="{0}"\n>{1}</div>',r,e.map(function(t){return h.elementFor(t.styles)}).join("")),js:null}};var o=r.exports.Aggregator=function(t){var r=function(){var r=a.counter();t.forEach(function(t){r.add(t.join(";"))});for(var n=r.sortByMostFrequent(),e=a.generator(["i","b","a","p","q","u","s","em","h1","h2","h3","h4","h5","h6","ol","ul","dl","dfn","kbd","var","ins","del","sup","sub","nav","pre","div","bdi","span","samp","code","abbr","form","cite","mark","menu","small","aside","table"]),s={},o=0;o<n.length;o++){var i=n[o][0],u=n[o][1],l=e();if(1>=u||null===l)break;s[l]=i.split(";")}return s}();return{tags:r,classes:function(){var n=a.counter();t.forEach(function(t){for(var a=e(r,t).unmatchedStyles,s=0;s<a.length;s++)n.add(a[s])});for(var s=a.endlessGenerator("abcdefghijklmnopqrstuvwxyz"),o=n.sortByMostFrequent(),i={},u=0;u<o.length;u++){var l=o[u][0],f=o[u][1];if(1>=f)break;i[l]=s()}return i}()}},i=r.exports.Formatter=function(t){var r={defaultTag:function(){var r;for(var n in t.tags)(!r||n.length<r.length)&&(r=n);return r}(),styles:function(r){var n=[];for(var e in t.tags)n.push(a.format("{0} {1} { {2} }",r,e,t.tags[e].join("; ")));for(var s in t.classes)n.push(a.format("{0} .{1} { {2} }",r,t.classes[s],s));return n},valuesFor:function(n){for(var a=e(t.tags,n),s=a.tag||r.defaultTag,o=[],i=[],u=0;u<a.unmatchedStyles.length;u++){var l=a.unmatchedStyles[u];t.classes[l]?o.push(t.classes[l]):i.push(l)}return{tag:s,classes:o.join(" "),styles:i.join("; ")}},elementFor:function(t){var n=r.valuesFor(t),e="";return n.classes&&(e+=a.format(' class="{0}"',n.classes)),n.styles&&(e+=a.format(' style="{0}"',n.styles)),a.format("<{0}{1}></{0}\n>",n.tag,e)}};return r};i.fromStylesElements=function(t){var r=o(t);return i(r)}},{"../pixel-segments.js":10,"../util":12}],8:[function(t,r,n){function e(){function t(t,r,n){var e=2*r;return t.length<=e?n:parseInt(t.substr(e,2),16)}for(var r=document.querySelectorAll("canvas[data-image-html-js1]"),n=0;n<r.length;n++)for(var e=r[n],a=JSON.parse(e.getAttribute("data-image-html-js1")),s=e.getContext("2d"),o=s.createImageData(1,1),i=0;i<e.height;i++)for(var u=a[i].split(","),l=0;l<e.width;l++){var f=u[l];o.data[0]=t(f,0),o.data[1]=t(f,1),o.data[2]=t(f,2),o.data[3]=t(f,3,255),s.putImageData(o,l,i)}}var a=t("../util.js").format;r.exports=function(t,r){return{css:"canvas[data-image-html-js1] { vertical-align: top }",html:function(){var n=t.map(function(t){var r=t.map(function(t){return t.hex()});return r.join(",")});return a("<canvas id='{0}' width='{1}' height='{2}' data-image-html-js1='{3}'></canvas>",r,t.cols,t.rows,JSON.stringify(n))}(),js:a("({0})()",e.toString())}}},{"../util.js":12}],9:[function(t,r,n){var e=t("canvas-browserify").Image,a=t("./pixels"),s={html1:t("./formats/html1"),html2:t("./formats/html2"),html3:t("./formats/html3"),html4:t("./formats/html4"),js1:t("./formats/js1")},o=r.exports={formats:function(){return Object.keys(s)},convert:function(t,r,n){n=n||"html4";var e=a.fromImage(t),o=s[n](e,r);return o.page=function(){return["<!DOCTYPE html>","<html>","<head>","<style>",o.css,"</style>","</head>",'<body style="margin:0">',o.html,"</body>","<script>",o.js,"</script>","</html>"].join("\n")},o},convertData:function(t,r,n,a){"function"==typeof n&&(a=n,n=null);var s=new e;s.onload=function(){var t=o.convert(s,r,n);a(t)},s.src=t}}},{"./formats/html1":4,"./formats/html2":5,"./formats/html3":6,"./formats/html4":7,"./formats/js1":8,"./pixels":11,"canvas-browserify":2}],10:[function(t,r,n){r.exports=function(t){for(var r=[],n=0;n<t.rows;n++){r[n]=[];for(var e={value:null},a=0;a<t.cols;a++)t[n][a].equals(e.value)?e.length++:(e={length:1,value:t[n][a]},r[n].push(e))}return r}},{}],11:[function(t,r,n){var e=t("./color"),a=t("canvas-browserify"),s=r.exports=function(t){return t.rows=t.length,t.cols=t[0].length,t};s.fromImage=function(t){var r=new a(t.width,t.height),n=r.getContext("2d");n.drawImage(t,0,0);for(var o=n.getImageData(0,0,t.width,t.height).data,i=[],u=0;u<t.height;u++){i[u]=[];for(var l=0;l<t.width;l++){var f=4*(u*t.width+l),h=o[f],c=o[f+1],g=o[f+2],v=o[f+3];i[u][l]=e.rgba(h,c,g,v)}}return s(i)}},{"./color":3,"canvas-browserify":2}],12:[function(t,r,n){var e=r.exports={format:function(){for(var t=[],r=0;10>r;r++)t[r]=new RegExp("\\{"+r+"\\}","gm");return function(){for(var r=arguments[0],n=1;n<arguments.length;n++)r=r.replace(t[n-1],arguments[n]);return r}}(),round:function(t,r){var n=r?Math.pow(10,r):1;return Math.round(t*n)/n},counter:function(t){function r(t){n[t]=(n[t]||0)+1}var n={};if(t)for(var a=0;a<t.length;a++)r(t[a]);return{count:n,add:r,sortByMostFrequent:function(){return e.objToArray(this.count).sort(function(t,r){return t[1]<r[1]?1:t[1]>r[1]?-1:0})}}},objToArray:function(t){var r=[];for(var n in t)r.push([n,t[n]]);return r},memoize:function(t){var r={};return function(){var n=[].join.apply(arguments);return r[n]||(r[n]=t.apply(this,arguments)),r[n]}},arrayEquals:function(t,r){if(t===r)return!0;if(!t||!r)return!1;if(t.length!=r.length)return!1;for(var n=0;n<r.length;++n)if(t[n]!==r[n])return!1;return!0},arrayDiff:function(t,r){for(var n=[],e=0;e<t.length;e++){var a=r.indexOf(t[e]);-1===a&&n.push(t[e])}return n},generator:function(t){var r=0;return function(){return r<t.length?t[r++]:null}},endlessGenerator:function(t){var r=[];return function(){for(var n=0;;){if(n>=r.length){r.push(0);break}if(++r[n]<t.length)break;r[n++]=0}return r.map(function(r){return t[r]}).join("")}}}},{}]},{},[1]);
